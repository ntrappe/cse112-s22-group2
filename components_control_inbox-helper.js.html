<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: components/control/inbox-helper.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: components/control/inbox-helper.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @module inboxHelper
 */

const EXIT_SUCCESS = 1;
const EXIT_FAILURE = 0;

const editBtn = document.getElementById('edit-btn');
const deleteAllBtn = document.getElementById('delete-all-btn');
const deleteSelectedBtn = document.getElementById('delete-selected-btn');
const newNoteBtn = document.getElementById('new-note-btn');

const deleteAllModal = document.getElementById('delete-all-modal');
const deleteSelectedModal = document.getElementById('delete-selected-modal');

const logList = document.getElementById('log-list');
const logs = logList.querySelectorAll('#log-list>li');
const logNumber = logList.querySelectorAll('#log-list>li').length;
const logCountDisplay = document.getElementById('log-count-display');

// display the number of logs
logCountDisplay.innerText = `${logNumber} logs`;

// set event listeners for buttons
editBtn.addEventListener('click', toggleCheckboxDisplay);
deleteAllBtn.addEventListener('click', deleteAllLogs);
deleteSelectedBtn.addEventListener('click', deleteSelectedLogs);

// When a log is clicked, check/uncheck its corresponding checkbox
logs.forEach((log) => {
    // prevent clicking the input directly from triggering triggering the log click event
    // otherwise clicking input directly will actually tick checkbox twice and not work
    const checkbox = log.children[0];
    checkbox.onclick = (e) => { e.stopPropagation(); };

    log.addEventListener('click', (event) => {
        tickCheckbox(checkbox);
    });
});

/**
 * @name toggleCheckboxDisplay
 * @function
 * @description toggles the display of the delete checkboxes and updates the edit/cancel
 * button accordingly
 */
function toggleCheckboxDisplay() {
    /* must re-query select each time event listener triggered bc control
     * creates a new set of checkboxes every time we open and close a log */
    const checkboxes = document.querySelectorAll('input[type=checkbox]');
    const inboxInfo = document.getElementById('inbox-info');

    // show checkboxes when edit is clicked and set text to cancel
    if (editBtn.innerText === 'Edit') {
        editBtn.innerText = 'Cancel';
        editBtn.dispatchEvent(activeEditEvent); // tell control in edit mode

        checkboxes.forEach((checkbox) => {
            console.log('SET CHECKBOXES');
            checkbox.checked = false;
            checkbox.style.display = 'grid';
        });
        logs.forEach((log) => {
            log.style.cursor = 'pointer';
        });

        inboxInfo.style.display = 'none';
        newNoteBtn.style.display = 'none';
        deleteAllBtn.style.display = 'block';
        deleteSelectedBtn.style.display = 'block';
    } else { // stop showing checkboxes when cancel is clicked and set text back to edit
        editBtn.innerText = 'Edit';
        editBtn.dispatchEvent(deactiveEditEvent); // tell control in edit mode

        checkboxes.forEach((checkbox) => {
            checkbox.style.display = 'none';
            console.log('REMOVE CHECKBOXES');
        });
        logs.forEach((log) => {
            log.style.cursor = 'default';
        });

        inboxInfo.style.display = 'block';
        newNoteBtn.style.display = 'block';
        deleteAllBtn.style.display = 'none';
        deleteSelectedBtn.style.display = 'none';
    }
}

function deleteAllLogs() {
    // show modal
    deleteAllModal.style.display = 'block';
}

function deleteSelectedLogs() {
    const numLogSelected = logList.querySelectorAll('input:checked').length;
    if (numLogSelected > 0) {
        // set the text according to the number of logs wanting to delete + display modal
        const deleteSelectedKids = deleteSelectedModal.shadowRoot.childNodes[1];
        const confirmationMessage = deleteSelectedKids.firstChild.firstChild;
        confirmationMessage.innerText = `Do you want to delete ${numLogSelected} daily logs?`;
        deleteSelectedModal.style.display = 'block';
    }
}

function tickCheckbox(checkbox) {
    // if the checkbox is checked
    if (checkbox.checked) {
        checkbox.checked = false;
    } else {
        checkbox.checked = true;
    }
}

/* Events */
/**
 * When user clicks 'Edit', they are now in edit mode so
 * let control know (so that other operations are suspended)
 */
const activeEditEvent = new CustomEvent('activeEdit', {
    bubbles: true, // event listenable outside of container
    composed: true,
});

/**
 * When user clicks 'Cancel', they are NOT in edit mode
 * so normal operations can resume
 */
const deactiveEditEvent = new CustomEvent('deactiveEdit', {
    bubbles: true, // event listenable outside of container
    composed: true,
});
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="DailyLogPreview%250AClass%2520that%2520renders%2520a%2520brief%2520preview%2520of%2520a%2520daily%2520logmodule_.html">DailyLogPreview
Class that renders a brief preview of a daily log</a></li><li><a href="DailyLogPreview%250AClass%2520that%2520renders%2520a%2520full%2520daily%2520logmodule_.html">DailyLogPreview
Class that renders a full daily log</a></li><li><a href="module-add-component.html">add-component</a></li><li><a href="module-inboxHelper.html">inboxHelper</a></li><li><a href="module-Storage.html">Storage</a></li></ul><h3>Global</h3><ul><li><a href="global.html#changeBulletChangesthebullettypetoselectedbulletandautoclosesmodal">changeBullet
Changes the bullet type to selected bullet and auto closes modal</a></li><li><a href="global.html#convertStorageDate">convertStorageDate</a></li><li><a href="global.html#createListElementCreatesanewnoteentryelementandappendsittotheNotessection">createListElement
Creates a new note entry element and appends it to the Notes section</a></li><li><a href="global.html#currentEntries">currentEntries</a></li><li><a href="global.html#deleteEntryDeletesabulletiftheuserpressesbackspaceonanemptybulletanddeletesentryfromcurrentEntries.Helperfunctionforcontrol.">deleteEntry
Deletes a bullet if the user presses backspace on an empty bullet
and deletes entry from currentEntries.
Helper function for control.</a></li><li><a href="global.html#deleteEntryUpdatesvalueofentryincurrentEntries.">deleteEntry
Updates value of entry in currentEntries.</a></li><li><a href="global.html#enterKeyPressedCreatesanewbulletonthenextlineiftheuserpressesenterandaddscurrententrytocurrentEntries,orifanexistingbulletiseditedthenitupdatestheentryincurrentEntriesHelperfunctionforcontrol.">enterKeyPressed
Creates a new bullet on the next line if the user presses enter and adds
current entry to currentEntries, or if an existing bullet is edited then
it updates the entry in currentEntries
Helper function for control.</a></li><li><a href="global.html#launchBulletModalUpdatesmostrecentbulletwiththebulletthattriggeredthiseventhandlerandlaunchesbulletmodalwithadisplayofthisselectedlistelement">launchBulletModal
Updates most recent bullet with the bullet that triggered this event handler
and launches bullet modal with a display of this selected list element</a></li><li><a href="global.html#notesClickHidesthenotesplaceholderandcreatesanewbullet.">notesClick
Hides the notes placeholder and creates a new bullet.</a></li><li><a href="global.html#populateListElementYesthisisaveryredundantfunction.(TODO:relyonabovefxn).Willrepopulatethelistofbulletpointsfromlocalstoragebycreatingabulletpoint,addingcontent,andsettingbulletstyle.">populateListElement
Yes this is a very redundant function. (TODO: rely on above fxn).
Will repopulate the list of bullet points from local storage
by creating a bullet point, adding content, and setting bullet style.</a></li><li><a href="global.html#setDefaultDateHelperfunctiontofetchcurrentdateandformattobe%2522%257Bdayofweek%257D,%257Bmonth%257D%257Bdate%257D,%257Byear%257D%2522">setDefaultDate
Helper function to fetch current date and format
to be "{day of week}, {month} {date}, {year}"</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.4</a> on Thu Jun 09 2022 23:17:38 GMT+0000 (Coordinated Universal Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
